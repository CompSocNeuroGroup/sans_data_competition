
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accessing Data &#8212; SANS 2022 Data Competition</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.e2363ea40746bee74734a24ffefccd78.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Registration" href="Registration.html" />
    <link rel="prev" title="Overview" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/CSAN_Logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SANS 2022 Data Competition</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Accessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Registration.html">
   Registration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Submission.html">
   Submission
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Additional Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://dartbrains.org/content/Introduction_to_Programming.html">
   Introduction to Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://dartbrains.org/content/Introduction_to_Pandas.html">
   Introduction to Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://dartbrains.org/content/Introduction_to_Plotting.html">
   Introduction to Plotting in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://dartbrains.org/content/Introduction_to_Neuroimaging_Data.html">
   Introduction to Neuroimaging Data with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://dartbrains.org/">
   Dartbrains Neuroimaging Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://naturalistic-data.org/">
   Naturalistic Data Analysis Course
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Post questions to <a href='https://www.askpbs.org/c/compsan-data-competition'>CompSAN Discourse</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/Download_Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/computational-san/sans_data_competition"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/computational-san/sans_data_competition/issues/new?title=Issue%20on%20page%20%2Fcontent/Download_Data.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/computational-san/sans_data_competition/edit/master/content/Download_Data.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/computational-san/sans_data_competition/master?urlpath=tree/content/Download_Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/computational-san/sans_data_competition/blob/master/content/Download_Data.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Accessing Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-data">
   Downloading Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datalad">
     DataLad
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installing-datalad">
       Installing Datalad
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#download-data-with-datalad">
       Download Data with DataLad
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datalad-basics">
     Datalad Basics
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#getting-data">
       Getting Data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dropping-data">
       Dropping Data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datalad-has-a-python-api">
     Datalad has a Python API
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="accessing-data">
<h1>Accessing Data<a class="headerlink" href="#accessing-data" title="Permalink to this headline">¶</a></h1>
<p>For this data competition, we will be using the Friday Night Lights dataset from:</p>
<p><a class="reference external" href="https://www.science.org/doi/10.1126/sciadv.abf7129">Chang, L. J., Jolly, E., Cheong, J. H., Rapuano, K. M., Greenstein, N., Chen, P. H. A., &amp; Manning, J. R. (2021). Endogenous variation in ventromedial prefrontal cortex state dynamics during naturalistic viewing reflects affective experience. <em>Science Advances, 7(17), eabf7129</em>.</a></p>
<p>In this dataset, participants (n=35) watched the pilot episode of the NBC television show Friday Night Lights while undergoing fMRI. We are sharing the raw data in the BIDS format. We are also sharing data that has been preprocessed using fMRIPrep version 20.2.1. See <code class="docutils literal notranslate"><span class="pre">derivatives/code/fmriprep.sh</span></code> for the script used to run preprocessing. We have also performed denoising on the preprocessed data by running a univariate GLM, which included the following regressors:</p>
<ul class="simple">
<li><p>Intercept, Linear &amp; Quadratic Trends (3)</p></li>
<li><p>Expanded Realignment Parameters (24). Derivatives, quadratics, quadratic derivatives</p></li>
<li><p>Spikes based on global outliers greater than 3 SD and also based on average frame differencing</p></li>
<li><p>CSF regressor (1)</p></li>
</ul>
<p>See <code class="docutils literal notranslate"><span class="pre">derivatives/code/Denoise_Preprocessed_Data.ipynb</span></code> file for full details of the denoising model. We have included denoised data that is unsmoothed and also has been smoothed with a 6mm FWHM Gaussian kernel. We have included nifti and hdf5 versions of the data. Nifti files can be loaded using any software. HDF5 files are much faster to load if you are using our <a class="reference external" href="https://nltools.org/">nltools</a> toolbox for your data analyses. Note that subject <code class="docutils literal notranslate"><span class="pre">sub-sid000496</span></code> had bad normalization using this preprocessing pipeline, so we have not included this participant in the denoised data.</p>
<p>We are also sharing additional data from this paper, which may be used in projects:</p>
<ul class="simple">
<li><p>Study 1 (n=13) fMRI Data viewing episodes 1 &amp; 2 - Available on <a class="reference external" href="https://openneuro.org/datasets/ds003524">OpenNeuro</a>.</p></li>
<li><p>Study 3 (n=20) Face Expression Data - Available on <a class="reference external" href="https://osf.io/f9gyd/">OSF</a>. We are only sharing extracted Action Unit Values. We do not have permission to share raw video data.</p></li>
<li><p>Study 4 (n=192) Emotion Ratings - Available on <a class="reference external" href="https://osf.io/f9gyd/">OSF</a>. Rating data was collected on Amazon Mechanical Turk using a custom Flask <a class="reference external" href="https://github.com/cosanlab/moth_app">web application</a>.</p></li>
<li><p>Code from the original paper is available on <a class="reference external" href="https://github.com/cosanlab/vmPFC_dynamics">Github</a></p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="downloading-data">
<h1>Downloading Data<a class="headerlink" href="#downloading-data" title="Permalink to this headline">¶</a></h1>
<p>All of the data is being hosted by <a class="reference external" href="https://openneuro.org/datasets/ds003521">OpenNeuro</a>. The entire dataset is about 16gb and can be downloaded directly from the website and also using the AWS command line interface. See the OpenNeuro <a class="reference external" href="https://openneuro.org/datasets/ds003521/download">instructions</a> for downloading. If you have limited storage space, we recommend using Datalad to only download the files you want to work with. We have included a brief overview of working with Datalad from the command line and within Python below.</p>
<div class="section" id="datalad">
<h2>DataLad<a class="headerlink" href="#datalad" title="Permalink to this headline">¶</a></h2>
<p>We encourage participants to download the data using <a class="reference external" href="https://www.datalad.org/">DataLad</a>, which is an open source version control system for data built on top of <a class="reference external" href="https://git-annex.branchable.com/">git-annex</a>. Think of it like git for data. It provides a handy command line interface for downloading data, tracking changes, and sharing it with others.</p>
<p>While DataLad offers a number of useful features for working with datasets, there are three in particular that we think make it worth the effort to install for this competition.</p>
<ol class="simple">
<li><p>Cloning a DataLad Repository can be completed with a single line of code <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">install</span> <span class="pre">&lt;repository&gt;</span></code> and provides the full directory structure in the form of symbolic links. This allows you to explore all of the files in the dataset, without having to download the entire dataset at once.</p></li>
<li><p>Specific files can be easily downloaded using <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">get</span> <span class="pre">&lt;filename&gt;</span></code>, and files can be removed from your computer at any time using <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">drop</span> <span class="pre">&lt;filename&gt;</span></code>. As the dataset is relatively large, this will allow you to only work with the data that you need and you can drop the rest when you are done with it.</p></li>
<li><p>All of the DataLad commands can be run within Python using the datalad <a class="reference external" href="http://docs.datalad.org/en/latest/modref.html">python api</a>.</p></li>
</ol>
<p>We will only be covering a few basic DataLad functions to get and drop data. We encourage the interested reader to read the very comprehensive DataLad <a class="reference external" href="http://handbook.datalad.org/en/latest/">User Handbook</a> for more details and troubleshooting.</p>
<div class="section" id="installing-datalad">
<h3>Installing Datalad<a class="headerlink" href="#installing-datalad" title="Permalink to this headline">¶</a></h3>
<p>DataLad can be easily installed using <a class="reference external" href="https://pip.pypa.io/en/stable/">pip</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">datalad</span></code></p>
<p>Unfortunately, it currently requires manually installing the <a class="reference external" href="https://git-annex.branchable.com/">git-annex</a> dependency, which is not automatically installed using pip.</p>
<p>If you are using OSX, we recommend installing git-annex using <a class="reference external" href="https://brew.sh/">homebrew</a> package manager.</p>
<p><code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">git-annex</span></code></p>
<p>If you are on Debian/Ubuntu we recommend enabling the <a class="reference external" href="http://neuro.debian.net/">NeuroDebian</a> repository and installing with apt-get.</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">datalad</span></code></p>
<p>For more installation options, we recommend reading the DataLad <a class="reference external" href="https://git-annex.branchable.com/">installation instructions</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install datalad
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: datalad in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (0.14.7)
Requirement already satisfied: fasteners&gt;=0.14 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (0.16.3)
Requirement already satisfied: PyGithub in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.55)
Requirement already satisfied: distro in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.6.0)
Requirement already satisfied: simplejson in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (3.17.3)
Requirement already satisfied: boto in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (2.49.0)
Requirement already satisfied: appdirs in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.4.4)
Requirement already satisfied: wrapt in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.12.1)
Requirement already satisfied: requests&gt;=1.2 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (2.26.0)
Requirement already satisfied: humanize in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (3.11.0)
Requirement already satisfied: keyring&gt;=8.0 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (23.4.0)
Requirement already satisfied: tqdm in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (4.62.3)
Requirement already satisfied: keyrings.alt in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (4.1.0)
Requirement already satisfied: patool&gt;=1.7 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.12)
Requirement already satisfied: annexremote in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.5.0)
Requirement already satisfied: iso8601 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (0.1.16)
Requirement already satisfied: whoosh in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (2.7.4)
Requirement already satisfied: chardet&gt;=3.0.4 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (4.0.0)
Requirement already satisfied: python-gitlab in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (2.10.0)
Requirement already satisfied: msgpack in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (1.0.2)
Requirement already satisfied: jsmin in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from datalad) (2.2.2)
Requirement already satisfied: six in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from fasteners&gt;=0.14-&gt;datalad) (1.16.0)
Requirement already satisfied: importlib-metadata&gt;=3.6 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from keyring&gt;=8.0-&gt;datalad) (4.8.2)
Requirement already satisfied: zipp&gt;=0.5 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from importlib-metadata&gt;=3.6-&gt;keyring&gt;=8.0-&gt;datalad) (3.6.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from requests&gt;=1.2-&gt;datalad) (2021.10.8)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from requests&gt;=1.2-&gt;datalad) (1.26.7)
Requirement already satisfied: charset-normalizer~=2.0.0 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from requests&gt;=1.2-&gt;datalad) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from requests&gt;=1.2-&gt;datalad) (3.3)
Requirement already satisfied: future in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from annexremote-&gt;datalad) (0.18.2)
Requirement already satisfied: setuptools in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from humanize-&gt;datalad) (58.0.4)
Requirement already satisfied: pyjwt&gt;=2.0 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from PyGithub-&gt;datalad) (2.1.0)
Requirement already satisfied: pynacl&gt;=1.4.0 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from PyGithub-&gt;datalad) (1.4.0)
Requirement already satisfied: deprecated in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from PyGithub-&gt;datalad) (1.2.12)
Requirement already satisfied: cffi&gt;=1.4.1 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from pynacl&gt;=1.4.0-&gt;PyGithub-&gt;datalad) (1.14.6)
Requirement already satisfied: pycparser in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from cffi&gt;=1.4.1-&gt;pynacl&gt;=1.4.0-&gt;PyGithub-&gt;datalad) (2.21)
Requirement already satisfied: requests-toolbelt&gt;=0.9.1 in /Users/lukechang/opt/anaconda3/lib/python3.8/site-packages (from python-gitlab-&gt;datalad) (0.9.1)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="download-data-with-datalad">
<h3>Download Data with DataLad<a class="headerlink" href="#download-data-with-datalad" title="Permalink to this headline">¶</a></h3>
<p>The FNL dataset can be accessed at the following location https://openneuro.org/datasets/ds003521. To download the dataset run <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">install</span> <span class="pre">https://github.com/OpenNeuroDatasets/ds003521.git</span></code> in a terminal in the location where you would like to install the dataset. Don’t forget to change the directory to a folder on your local computer. The full dataset is approximately 16gb.</p>
<p>You can run this from the notebook using the <code class="docutils literal notranslate"><span class="pre">!</span></code> cell magic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">download_path</span> <span class="o">=</span> <span class="s1">&#39;/Users/lukechang/Downloads/FridayNightLights&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">download_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_path</span><span class="p">)</span>

<span class="o">%</span><span class="k">cd</span> {download_path}

<span class="o">!</span>datalad install https://github.com/OpenNeuroDatasets/ds003521.git
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/lukechang/Downloads/FridayNightLights
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="datalad-basics">
<h2>Datalad Basics<a class="headerlink" href="#datalad-basics" title="Permalink to this headline">¶</a></h2>
<p>You might be surprised to find that after cloning the dataset that it barely takes up any space using <code class="docutils literal notranslate"><span class="pre">du</span> <span class="pre">-sh</span></code>. This is because cloning only downloads the metadata of the dataset to see what files are included.</p>
<p>You can check to see how big the entire dataset would be if you downloaded everything using <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">status</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">cd</span> ~/Downloads/FridayNightLights/ds003521

<span class="o">!</span>datalad status --annex
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/lukechang/Downloads/FridayNightLights/ds003521
untracked: ds003521 (directory)
70 annex&#39;d files (9.7 GB recorded total size)
</pre></div>
</div>
</div>
</div>
<div class="section" id="getting-data">
<h3>Getting Data<a class="headerlink" href="#getting-data" title="Permalink to this headline">¶</a></h3>
<p>One of the really nice features of datalad is that you can see all of the data without actually storing it on your computer. When you want a specific file you use <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">get</span> <span class="pre">&lt;filename&gt;</span></code> to download that specific file. Importantly, you do not need to download all of the data at once, only when you need it.</p>
<p>Now that we have cloned the repository we can grab individual files. For example, suppose we wanted to grab the first subject’s confound regressors generated by fmriprep.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>datalad get participants.tsv
</pre></div>
</div>
</div>
</div>
<p>Now we can check and see how much of the total dataset we have downloaded using <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">status</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>datalad status --annex all
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>untracked: ds003521 (directory)
70 annex&#39;d files (0.0 B/9.7 GB present/total size)
</pre></div>
</div>
</div>
</div>
<p>If you would like to download all of the files you can use <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">get</span> <span class="pre">.</span></code>. Depending on the size of the dataset and the speed of your internet connection, this might take awhile. One really nice thing about datalad is that if your connection is interrupted you can simply run <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">get</span> <span class="pre">.</span></code> again, and it will resume where it left off.</p>
<p>You can also install the dataset and download all of the files with a single command <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">install</span> <span class="pre">-g</span> <span class="pre">https://github.com/OpenNeuroDatasets/ds003521.git</span></code>. You may want to do this if you have a lot of storage available and a fast internet connection. For most people, we recommend only downloading the files you need for your project.</p>
</div>
<div class="section" id="dropping-data">
<h3>Dropping Data<a class="headerlink" href="#dropping-data" title="Permalink to this headline">¶</a></h3>
<p>Most people do not have unlimited space on their hard drives and are constantly looking for ways to free up space when they are no longer actively working with files. Any file in a dataset can be removed using <code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">drop</span></code>. Importantly, this does not delete the file, but rather removes it from your computer. You will still be able to see file metadata after it has been dropped in case you want to download it again in the future.</p>
<p>As an example, let’s drop the Localizer participants .tsv file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>datalad drop participants.tsv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="datalad-has-a-python-api">
<h2>Datalad has a Python API<a class="headerlink" href="#datalad-has-a-python-api" title="Permalink to this headline">¶</a></h2>
<p>One particularly nice aspect of datalad is that it has a Python API, which means that anything you would like to do with datalad in the commandline, can also be run in Python. See the details of the datalad <a class="reference external" href="http://docs.datalad.org/en/latest/modref.html">Python API</a>.</p>
<p>For example, suppose you would like to clone a data repository, such as the Localizer dataset. You can run <code class="docutils literal notranslate"><span class="pre">dl.clone(source=url,</span> <span class="pre">path=location)</span></code>. Make sure you set <code class="docutils literal notranslate"><span class="pre">localizer_path</span></code> to the location where you would like the Localizer repository installed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">datalad.api</span> <span class="k">as</span> <span class="nn">dl</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">download_path</span> <span class="o">=</span> <span class="s1">&#39;/Users/lukechang/Downloads/FridayNightLights&#39;</span>

<span class="n">dl</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;https://github.com/OpenNeuroDatasets/ds003521.git&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">localizer_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">lt</span><span class="o">/</span><span class="mi">52_7</span><span class="n">v4r10qg8m6_2fjzqh1z80000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_78597</span><span class="o">/</span><span class="mf">482638609.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">glob</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">datalad.api</span> <span class="k">as</span> <span class="nn">dl</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">datalad</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> 
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="kn">from</span> <span class="nn">.config</span> <span class="kn">import</span> <span class="n">ConfigManager</span>
<span class="ne">---&gt; </span><span class="mi">48</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigManager</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span> 
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="kn">from</span> <span class="nn">.log</span> <span class="kn">import</span> <span class="n">lgr</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/datalad/config.py</span> in <span class="ni">__init__</span><span class="nt">(self, dataset, overrides, source)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_runner</span> <span class="o">=</span> <span class="n">GitWitlessRunner</span><span class="p">(</span><span class="o">**</span><span class="n">run_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span> 
<span class="ne">--&gt; </span><span class="mi">346</span>         <span class="bp">self</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span> 
<span class="g g-Whitespace">    </span><span class="mi">348</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">ConfigManager</span><span class="o">.</span><span class="n">_checked_git_identity</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/datalad/config.py</span> in <span class="ni">reload</span><span class="nt">(self, force)</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span>         <span class="k">while</span> <span class="n">to_run</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span>             <span class="n">store_id</span><span class="p">,</span> <span class="n">runargs</span> <span class="o">=</span> <span class="n">to_run</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">399</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_stores</span><span class="p">[</span><span class="n">store_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reload</span><span class="p">(</span><span class="n">runargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span> 
<span class="g g-Whitespace">    </span><span class="mi">401</span>         <span class="c1"># always update the merged representation, even if we did not reload</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/datalad/config.py</span> in <span class="ni">_reload</span><span class="nt">(self, run_args)</span>
<span class="g g-Whitespace">    </span><span class="mi">425</span>     <span class="k">def</span> <span class="nf">_reload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_args</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span>         <span class="c1"># query git-config</span>
<span class="ne">--&gt; </span><span class="mi">427</span>         <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">428</span>             <span class="n">run_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">429</span>             <span class="n">protocol</span><span class="o">=</span><span class="n">StdOutErrCapture</span><span class="p">,</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/datalad/config.py</span> in <span class="ni">_run</span><span class="nt">(self, args, where, reload, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span>         <span class="k">if</span> <span class="s1">&#39;-l&#39;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>             <span class="c1"># we are just reading, no need to reload, no need to lock</span>
<span class="ne">--&gt; </span><span class="mi">789</span>             <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_cmd</span> <span class="o">+</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>             <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;stdout&#39;</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;stderr&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/datalad/cmd.py</span> in <span class="ni">run</span><span class="nt">(self, cmd, protocol, stdin, cwd, env, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span>             <span class="n">lgr</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Async run:</span><span class="se">\n</span><span class="s1"> cwd=</span><span class="si">%s</span><span class="se">\n</span><span class="s1"> cmd=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>             <span class="c1"># include the subprocess manager in the asyncio event loop</span>
<span class="ne">--&gt; </span><span class="mi">379</span>             <span class="n">results</span> <span class="o">=</span> <span class="n">event_loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span>                 <span class="n">run_async_cmd</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>                     <span class="n">event_loop</span><span class="p">,</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/asyncio/base_events.py</span> in <span class="ni">run_until_complete</span><span class="nt">(self, future)</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span><span class="s2">         self._check_closed()</span>
<span class="ne">--&gt; </span><span class="mi">592</span><span class="s2">         self._check_running()</span>
<span class="g g-Whitespace">    </span><span class="mi">593</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">594</span><span class="s2">         new_task = not futures.isfuture(future)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/asyncio/base_events.py</span> in <span class="ni">_check_running</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">550</span><span class="s2">     def _check_running(self):</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span><span class="s2">         if self.is_running():</span>
<span class="ne">--&gt; </span><span class="mi">552</span><span class="s2">             raise RuntimeError(&#39;This event loop is already running&#39;)</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span><span class="s2">         if events._get_running_loop() is not None:</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span><span class="s2">             raise RuntimeError(</span>

<span class="ne">RuntimeError</span>: This event loop is already running
</pre></div>
</div>
</div>
</div>
<p>We can now create a dataset instance using <code class="docutils literal notranslate"><span class="pre">dl.Dataset(path_to_data)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">download_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>How much of the dataset have we downloaded?  We can check the status of the annex using <code class="docutils literal notranslate"><span class="pre">ds.status(annex='all')</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">annex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1794 annex&#39;d files (0.0 B/42.1 GB present/total size)
1794 annex&#39;d files (0.0 B/42.1 GB present/total size)
</pre></div>
</div>
</div>
</div>
<p>Looks like it’s empty, which makes sense since we only cloned the dataset.</p>
<p>Now we need to get some data. Let’s start with something small to play with first.</p>
<p>Let’s use <code class="docutils literal notranslate"><span class="pre">glob</span></code> to find all of the tab-delimited confound data generated by fmriprep.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;fmriprep&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="s1">&#39;*tsv&#39;</span><span class="p">))</span>
<span class="n">file_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">file_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S01/func/sub-S01_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S02/func/sub-S02_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S03/func/sub-S03_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S04/func/sub-S04_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S05/func/sub-S05_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S06/func/sub-S06_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S07/func/sub-S07_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S08/func/sub-S08_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S09/func/sub-S09_task-localizer_desc-confounds_regressors.tsv&#39;,
 &#39;/Users/lukechang/Dropbox/Dartbrains/data/Localizer/derivatives/fmriprep/sub-S10/func/sub-S10_task-localizer_desc-confounds_regressors.tsv&#39;]
</pre></div>
</div>
</div>
</div>
<p>glob can search the filetree and see all of the relevant data even though none of it has been downloaded yet.</p>
<p>Let’s now download the first subjects confound regressor file and load it using pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">confounds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">confounds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>csf</th>
      <th>csf_derivative1</th>
      <th>csf_derivative1_power2</th>
      <th>csf_power2</th>
      <th>white_matter</th>
      <th>white_matter_derivative1</th>
      <th>white_matter_power2</th>
      <th>white_matter_derivative1_power2</th>
      <th>global_signal</th>
      <th>global_signal_derivative1</th>
      <th>...</th>
      <th>rot_x_derivative1_power2</th>
      <th>rot_x_power2</th>
      <th>rot_y</th>
      <th>rot_y_derivative1</th>
      <th>rot_y_derivative1_power2</th>
      <th>rot_y_power2</th>
      <th>rot_z</th>
      <th>rot_z_derivative1</th>
      <th>rot_z_derivative1_power2</th>
      <th>rot_z_power2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5164.630182</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.667340e+07</td>
      <td>4006.007667</td>
      <td>NaN</td>
      <td>1.604810e+07</td>
      <td>NaN</td>
      <td>3753.537871</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>4.016403e-07</td>
      <td>0.000344</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.180596e-07</td>
      <td>-0.000701</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.914346e-07</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5178.481411</td>
      <td>13.851229</td>
      <td>191.856548</td>
      <td>2.681667e+07</td>
      <td>4011.819383</td>
      <td>5.811716</td>
      <td>1.609469e+07</td>
      <td>33.776043</td>
      <td>3760.408417</td>
      <td>6.870546</td>
      <td>...</td>
      <td>8.622980e-09</td>
      <td>2.925631e-07</td>
      <td>0.000569</td>
      <td>0.000225</td>
      <td>5.063355e-08</td>
      <td>3.233253e-07</td>
      <td>-0.000776</td>
      <td>-0.000075</td>
      <td>5.666476e-09</td>
      <td>6.026417e-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5161.040643</td>
      <td>-17.440768</td>
      <td>304.180395</td>
      <td>2.663634e+07</td>
      <td>4006.766409</td>
      <td>-5.052974</td>
      <td>1.605418e+07</td>
      <td>25.532548</td>
      <td>3756.426086</td>
      <td>-3.982332</td>
      <td>...</td>
      <td>6.975673e-08</td>
      <td>6.480347e-07</td>
      <td>0.000655</td>
      <td>0.000086</td>
      <td>7.409422e-09</td>
      <td>4.286255e-07</td>
      <td>-0.000524</td>
      <td>0.000253</td>
      <td>6.390582e-08</td>
      <td>2.740564e-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5150.604178</td>
      <td>-10.436465</td>
      <td>108.919794</td>
      <td>2.652872e+07</td>
      <td>4008.586021</td>
      <td>1.819612</td>
      <td>1.606876e+07</td>
      <td>3.310987</td>
      <td>3751.566090</td>
      <td>-4.859996</td>
      <td>...</td>
      <td>1.673784e-07</td>
      <td>1.567265e-07</td>
      <td>0.000554</td>
      <td>-0.000101</td>
      <td>1.011674e-08</td>
      <td>3.070412e-07</td>
      <td>-0.000605</td>
      <td>-0.000082</td>
      <td>6.722360e-09</td>
      <td>3.666230e-07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5172.441161</td>
      <td>21.836983</td>
      <td>476.853810</td>
      <td>2.675415e+07</td>
      <td>4007.189291</td>
      <td>-1.396730</td>
      <td>1.605757e+07</td>
      <td>1.950854</td>
      <td>3746.298200</td>
      <td>-5.267890</td>
      <td>...</td>
      <td>2.102616e-08</td>
      <td>2.925631e-07</td>
      <td>0.000997</td>
      <td>0.000443</td>
      <td>1.959195e-07</td>
      <td>9.934926e-07</td>
      <td>-0.000840</td>
      <td>-0.000235</td>
      <td>5.510428e-08</td>
      <td>7.059982e-07</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 136 columns</p>
</div></div></div>
</div>
<p>What if we wanted to drop that file? Just like the CLI, we can use <code class="docutils literal notranslate"><span class="pre">ds.drop(file_name)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>To confirm that it is actually removed, let’s try to load it again with pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confounds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Looks like it was successfully removed.</p>
<p>We can also load the entire dataset in one command if want using <code class="docutils literal notranslate"><span class="pre">ds.get(dataset='.',</span> <span class="pre">recursive=True)</span></code>. We are not going to do it right now as this will take awhile and require lots of free hard disk space.</p>
<p>Let’s actually download one of the files we will be using in the tutorial. First, let’s use glob to get a list of all of the functional data that has been preprocessed by fmriprep, denoised, and smoothed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;smoothed&#39;</span><span class="p">,</span> <span class="s1">&#39;*_task-movie_run-1_space-MNI152NLin2009cAsym_desc-preproc_trim_smooth6_denoised_bold.hdf5&#39;</span><span class="p">))</span>
<span class="n">file_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">file_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">lt</span><span class="o">/</span><span class="mi">52_7</span><span class="n">v4r10qg8m6_2fjzqh1z80000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_78597</span><span class="o">/</span><span class="mf">4010213263.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">localizer_path</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;smoothed&#39;</span><span class="p">,</span> <span class="s1">&#39;*_task-movie_run-1_space-MNI152NLin2009cAsym_desc-preproc_trim_smooth6_denoised_bold.hdf5&#39;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">file_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">file_list</span>

<span class="ne">NameError</span>: name &#39;localizer_path&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now let’s download the first subject’s file using <code class="docutils literal notranslate"><span class="pre">ds.get()</span></code>. This file is 825mb, so this might take a few minutes depending on your internet speed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>How much of the dataset have we downloaded?  We can check the status of the annex using <code class="docutils literal notranslate"><span class="pre">ds.status(annex='all')</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">annex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1794 annex&#39;d files (106.9 MB/42.1 GB present/total size)
1794 annex&#39;d files (106.9 MB/42.1 GB present/total size)
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="intro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Overview</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Registration.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Registration</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Luke Chang, Mark Thornton, James Thompson<br/>
        
            &copy; Copyright 2022.<br/>
          <div class="extra_footer">
            This competition is supported by The Dartmouth Consortium for Interacting Minds and an NSF CAREER Award 1848370 to <a href='http://cosanlab.com'>Luke Chang</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-138270939-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>